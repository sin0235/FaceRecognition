{% extends "base.html" %} {% block content %}

<div class="card animate">
  <h2>Model Performance Dashboard</h2>
  <p class="subtitle">
    So sánh hiệu năng của 3 mô hình: ArcFace, FaceNet và LBPH.
  </p>

  <div
    style="
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 20px;
      margin-top: 30px;
    "
  >
    <div
      style="
        background: linear-gradient(135deg, #2563eb 0%, #1e40af 100%);
        color: white;
        padding: 25px;
        border-radius: 16px;
        text-align: center;
      "
    >
      <h3 style="font-size: 1.1em; opacity: 0.9">ArcFace</h3>
      <div style="font-size: 2.5em; font-weight: 700; margin: 15px 0">
        {{ metrics.arcface.accuracy }}%
      </div>
      <div style="font-size: 0.9em; opacity: 0.8">Accuracy</div>
    </div>

    <div
      style="
        background: linear-gradient(135deg, #7c3aed 0%, #5b21b6 100%);
        color: white;
        padding: 25px;
        border-radius: 16px;
        text-align: center;
      "
    >
      <h3 style="font-size: 1.1em; opacity: 0.9">FaceNet</h3>
      <div style="font-size: 2.5em; font-weight: 700; margin: 15px 0">
        {{ metrics.facenet.accuracy }}%
      </div>
      <div style="font-size: 0.9em; opacity: 0.8">Accuracy</div>
    </div>

    <div
      style="
        background: linear-gradient(135deg, #059669 0%, #047857 100%);
        color: white;
        padding: 25px;
        border-radius: 16px;
        text-align: center;
      "
    >
      <h3 style="font-size: 1.1em; opacity: 0.9">LBPH</h3>
      <div style="font-size: 2.5em; font-weight: 700; margin: 15px 0">
        {{ metrics.lbph.accuracy }}%
      </div>
      <div style="font-size: 0.9em; opacity: 0.8">Accuracy</div>
    </div>
  </div>

  <div style="margin-top: 40px">
    <h3 style="margin-bottom: 20px">Chi tiết Metrics</h3>
    <table style="width: 100%; border-collapse: collapse">
      <thead>
        <tr style="background: #f3f4f6">
          <th style="padding: 12px; text-align: left">Model</th>
          <th style="padding: 12px; text-align: center">Precision</th>
          <th style="padding: 12px; text-align: center">Recall</th>
          <th style="padding: 12px; text-align: center">F1-Score</th>
        </tr>
      </thead>
      <tbody>
        <tr style="border-bottom: 1px solid #eee">
          <td style="padding: 12px"><b style="color: #2563eb">ArcFace</b></td>
          <td style="padding: 12px; text-align: center">
            {{ metrics.arcface.precision }}
          </td>
          <td style="padding: 12px; text-align: center">
            {{ metrics.arcface.recall }}
          </td>
          <td style="padding: 12px; text-align: center">
            {{ metrics.arcface.f1 }}
          </td>
        </tr>
        <tr style="border-bottom: 1px solid #eee">
          <td style="padding: 12px"><b style="color: #7c3aed">FaceNet</b></td>
          <td style="padding: 12px; text-align: center">
            {{ metrics.facenet.precision }}
          </td>
          <td style="padding: 12px; text-align: center">
            {{ metrics.facenet.recall }}
          </td>
          <td style="padding: 12px; text-align: center">
            {{ metrics.facenet.f1 }}
          </td>
        </tr>
        <tr>
          <td style="padding: 12px"><b style="color: #059669">LBPH</b></td>
          <td style="padding: 12px; text-align: center">
            {{ metrics.lbph.precision }}
          </td>
          <td style="padding: 12px; text-align: center">
            {{ metrics.lbph.recall }}
          </td>
          <td style="padding: 12px; text-align: center">
            {{ metrics.lbph.f1 }}
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div style="margin-top: 40px">
    <canvas id="comparisonChart" height="100"></canvas>
  </div>
</div>

<script>
  const ctx = document.getElementById('comparisonChart');

  new Chart(ctx, {
    type: 'bar',
    data: {
      labels: ['Accuracy', 'Precision', 'Recall', 'F1-Score'],
      datasets: [
        {
          label: 'ArcFace',
          data: [{{ metrics.arcface.accuracy }}, {{ metrics.arcface.precision * 100 }}, {{ metrics.arcface.recall * 100 }}, {{ metrics.arcface.f1 * 100 }}],
          backgroundColor: '#2563eb'
        },
        {
          label: 'FaceNet',
          data: [{{ metrics.facenet.accuracy }}, {{ metrics.facenet.precision * 100 }}, {{ metrics.facenet.recall * 100 }}, {{ metrics.facenet.f1 * 100 }}],
          backgroundColor: '#7c3aed'
        },
        {
          label: 'LBPH',
          data: [{{ metrics.lbph.accuracy }}, {{ metrics.lbph.precision * 100 }}, {{ metrics.lbph.recall * 100 }}, {{ metrics.lbph.f1 * 100 }}],
          backgroundColor: '#059669'
        }
      ]
    },
    options: {
      responsive: true,
      plugins: {
        legend: { position: 'top' },
        title: { display: true, text: 'So sánh hiệu năng 3 Models' }
      },
      scales: {
        y: { beginAtZero: true, max: 100 }
      }
    }
  });
</script>

{% endblock %}

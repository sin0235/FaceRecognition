# Config ArcFace Training cho Kaggle
# Dataset: CelebA_Aligned_Balanced - 9343 classes, ~18 images/class
# Toi uu cho dataset nho voi nhieu classes

# Model Architecture
model:
  backbone: resnet50
  embedding_size: 512
  pretrained: true
  freeze_ratio: 0.0

# ArcFace Loss - DIEU CHINH CHO DATASET NHO
arcface:
  margin: 0.25
  scale: 48.0
  easy_margin: true

training:
  num_epochs: 50
  batch_size: 128
  num_workers: 8

  warmup:
    enabled: true
    epochs: 5
    start_lr: 0.0001

  optimizer:
    type: sgd
    lr: 0.005
    momentum: 0.9
    weight_decay: 0.0005

  scheduler:
    type: cosine
    step_size: 20
    gamma: 0.1
    eta_min: 0.00001

  grad_clip:
    enabled: true
    max_norm: 5.0

  early_stopping:
    enabled: true
    patience: 12
    min_delta: 0.0001

# Data Configuration
data:
  mode: folder

  # Paths (se bi override boi --data_dir)
  train_data_root: data/train
  val_data_root: data/val

  # CSV paths (chi dung khi mode: csv)
  train_csv: data/metadata/train_labels.csv
  val_csv: data/metadata/val_labels.csv

  min_images_per_identity: 5
  class_balanced_sampling: true
  augment_strength: heavy
  image_size: 112

  normalize:
    mean: [0.5, 0.5, 0.5]
    std: [0.5, 0.5, 0.5]

# Checkpointing
checkpoint:
  save_dir: /kaggle/working/checkpoints/arcface
  save_best: true
  save_interval: 1
  keep_last_n: 2

# Logging
logging:
  use_tensorboard: false
  log_dir: /kaggle/working/logs/arcface
  log_interval: 50

  embedding_vis:
    enabled: false

# Device
device: cuda

# Mixed Precision - bat de tang toc
mixed_precision:
  enabled: true

# Cau hinh ArcFace Training
# Ho tro ca Local va Google Colab

# Model Architecture
model:
  backbone: resnet50
  embedding_size: 512
  pretrained: true
  freeze_ratio: 0.8  # Dong bang 80% lop dau cua backbone

# ArcFace Loss
arcface:
  margin: 0.5  # m parameter
  scale: 64.0  # s parameter
  easy_margin: false

# Training
training:
  num_epochs: 50
  batch_size: 64
  num_workers: 4
  
  # Optimizer
  optimizer:
    type: sgd
    lr: 0.01
    momentum: 0.9
    weight_decay: 0.0005
  
  # Learning Rate Scheduler
  scheduler:
    type: step
    step_size: 10
    gamma: 0.1
  
  # Gradient Clipping
  grad_clip:
    enabled: true
    max_norm: 5.0
  
  # Early Stopping
  early_stopping:
    enabled: true
    patience: 10
    min_delta: 0.001

# Data Configuration
# Su dung bien moi truong hoac override tu command line
data:
  # Default paths (local Windows)
  train_csv: data/CelebA_Aligned/metadata/train_labels_filtered.csv
  val_csv: data/CelebA_Aligned/metadata/val_labels_filtered.csv
  train_data_root: data/CelebA_Aligned/train
  val_data_root: data/CelebA_Aligned/val
  
  # Image settings
  image_size: 112
  
  # Augmentation cho training
  augmentation:
    horizontal_flip: 0.5
    rotation_degrees: 10
    color_jitter:
      brightness: 0.2
      contrast: 0.2
      saturation: 0.1
      hue: 0.05
  
  # Normalization (ArcFace standard)
  normalize:
    mean: [0.5, 0.5, 0.5]
    std: [0.5, 0.5, 0.5]

# Checkpointing
checkpoint:
  save_dir: models/checkpoints
  save_best: true
  save_interval: 10
  metric: val_accuracy

# Logging
logging:
  use_tensorboard: true
  log_dir: logs/arcface
  log_interval: 100
  
  # Embedding visualization
  embedding_vis:
    enabled: true
    interval: 5
    num_samples: 1000

# Device (auto-detect neu de cuda)
device: cuda

# ============================================
# GOOGLE COLAB CONFIGURATION
# Uncomment section nay khi chay tren Colab
# ============================================
# colab:
#   drive_root: /content/drive/MyDrive/FaceRecognition
#   data:
#     train_csv: /content/drive/MyDrive/FaceRecognition/CelebA_Aligned/metadata/train_labels_filtered.csv
#     val_csv: /content/drive/MyDrive/FaceRecognition/CelebA_Aligned/metadata/val_labels_filtered.csv
#     train_data_root: /content/drive/MyDrive/FaceRecognition/CelebA_Aligned/train
#     val_data_root: /content/drive/MyDrive/FaceRecognition/CelebA_Aligned/val
#   checkpoint:
#     save_dir: /content/drive/MyDrive/FaceRecognition/models/checkpoints
#   logging:
#     log_dir: /content/drive/MyDrive/FaceRecognition/logs/arcface

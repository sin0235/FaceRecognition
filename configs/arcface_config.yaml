# Cấu hình ArcFace Training

# Model Architecture
model:
  backbone: resnet50
  embedding_size: 512
  pretrained: true
  freeze_ratio: 0.8  # Đóng băng 80% lớp đầu của backbone

# ArcFace Loss
arcface:
  margin: 0.5  # m parameter
  scale: 64.0  # s parameter
  easy_margin: false

# Training
training:
  num_epochs: 50
  batch_size: 64
  num_workers: 4
  
  # Optimizer
  optimizer:
    type: sgd
    lr: 0.01
    momentum: 0.9
    weight_decay: 0.0005
  
  # Learning Rate Scheduler
  scheduler:
    type: step
    step_size: 10
    gamma: 0.1
  
  # Gradient Clipping
  grad_clip:
    enabled: true
    max_norm: 5.0
  
  # Early Stopping
  early_stopping:
    enabled: true
    patience: 10
    min_delta: 0.001

# Data
data:
  train_csv: data/processed/train_metadata.csv
  val_csv: data/processed/val_metadata.csv
  image_size: 112
  
  # Augmentation cho training
  augmentation:
    horizontal_flip: 0.5
    rotation_degrees: 10
    color_jitter:
      brightness: 0.2
      contrast: 0.2
      saturation: 0.1
      hue: 0.05
  
  # Normalization
  normalize:
    mean: [0.5, 0.5, 0.5]
    std: [0.5, 0.5, 0.5]

# Checkpointing
checkpoint:
  save_dir: models/checkpoints
  save_best: true
  save_interval: 10  # Lưu mỗi 10 epochs
  metric: val_accuracy  # Metric để chọn best model

# Logging
logging:
  use_tensorboard: true
  log_dir: logs/arcface
  log_interval: 100  # Log mỗi 100 iterations
  
  # Embedding visualization
  embedding_vis:
    enabled: true
    interval: 5  # Visualize mỗi 5 epochs
    num_samples: 1000

# Device
device: cuda  # cuda hoặc cpu
